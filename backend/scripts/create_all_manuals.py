#!/usr/bin/env python
"""
全機能の詳細マニュアルを作成するスクリプト

使い方:
cd backend
python manage.py shell < scripts/create_all_manuals.py
"""

import os
import sys
import django

# Django設定
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from apps.knowledge.models import Manual, ManualCategory
from apps.tenants.models import Tenant


def get_or_create_category(tenant, name, parent=None, sort_order=0):
    """カテゴリを取得または作成"""
    category, created = ManualCategory.objects.get_or_create(
        tenant_ref=tenant,
        name=name,
        parent=parent,
        defaults={
            'sort_order': sort_order,
            'is_active': True,
        }
    )
    if created:
        print(f"  カテゴリ作成: {name}")
    return category


def create_manual(tenant, category, title, content, summary, tags, sort_order=0, is_pinned=False):
    """マニュアルを作成（既存の場合は更新）"""
    manual, created = Manual.objects.update_or_create(
        tenant_ref=tenant,
        title=title,
        defaults={
            'category': category,
            'content': content,
            'summary': summary,
            'tags': tags,
            'is_published': True,
            'is_pinned': is_pinned,
        }
    )
    action = "作成" if created else "更新"
    print(f"  マニュアル{action}: {title}")
    return manual


# =====================================
# 管理者向けマニュアル
# =====================================
ADMIN_MANUALS = [
    {
        "title": "【管理者】ダッシュボードの使い方",
        "summary": "管理画面のダッシュボード機能の説明",
        "tags": ["管理者", "ダッシュボード", "概要"],
        "is_pinned": True,
        "content": """# ダッシュボード

ダッシュボードは管理画面のトップページで、塾の運営状況を一目で把握できます。

## 画面構成

### 1. 統計サマリー
画面上部に主要な統計情報が表示されます：
- **生徒数**: 現在登録されている生徒の総数
- **保護者数**: 登録保護者の総数
- **今月の売上**: 当月の請求確定額
- **未払い件数**: 未入金の請求件数

### 2. グラフエリア
- **売上推移グラフ**: 過去12ヶ月の売上推移を折れ線グラフで表示
- **生徒数推移**: 入会・退会による生徒数の変動を確認

### 3. 最近のアクティビティ
- 新規入会申請
- チャットメッセージ
- 請求・入金情報

## 操作方法

1. 左側のサイドメニューから各機能にアクセス
2. 統計カードをクリックすると詳細画面に遷移
3. 期間フィルターで表示期間を変更可能

## よくある質問

**Q: 数値がリアルタイムで更新されない**
A: 画面右上の更新ボタンをクリックするか、ブラウザをリロードしてください。

**Q: グラフが表示されない**
A: データが不足している可能性があります。1ヶ月以上のデータが必要です。
"""
    },
    {
        "title": "【管理者】生徒管理",
        "summary": "生徒の登録・編集・検索方法",
        "tags": ["管理者", "生徒", "登録"],
        "content": """# 生徒管理

生徒の情報を管理する画面です。

## 機能一覧

### 1. 生徒一覧
- 登録済み生徒の一覧表示
- 名前、学年、所属校舎などで検索・フィルタリング
- CSVエクスポート機能

### 2. 生徒登録
新規生徒を登録する手順：

1. 「新規登録」ボタンをクリック
2. 基本情報を入力
   - 姓名（漢字・カナ）
   - 生年月日
   - 学年
   - 所属校舎
3. 保護者情報を紐付け
4. 「保存」をクリック

### 3. 生徒編集
1. 一覧から編集したい生徒をクリック
2. 詳細画面で「編集」ボタンをクリック
3. 情報を修正して「保存」

### 4. 検索・フィルター

検索ボックスに以下の情報で検索できます：
- 生徒番号
- 氏名（漢字・カナ）
- 旧ID

フィルター：
- 学年
- 校舎
- 在籍状況

## 注意事項

- 生徒を削除すると関連する受講履歴も非表示になります
- 保護者との紐付けは必須です
- 学年は毎年4月に自動更新されます（設定による）
"""
    },
    {
        "title": "【管理者】保護者管理",
        "summary": "保護者情報の管理方法",
        "tags": ["管理者", "保護者", "登録"],
        "content": """# 保護者管理

保護者（契約者）の情報を管理する画面です。

## 機能一覧

### 1. 保護者一覧
登録済み保護者の一覧を表示します。

表示項目：
- 保護者番号
- 氏名
- メールアドレス
- 電話番号
- 紐付け生徒数
- 登録日

### 2. 保護者登録

1. 「新規登録」ボタンをクリック
2. 以下の情報を入力：
   - 姓名（漢字・カナ）
   - メールアドレス
   - 電話番号
   - 住所
   - 支払い方法（口座振替/クレジットカード）
3. 「保存」をクリック

### 3. 生徒の紐付け

保護者詳細画面から：
1. 「生徒を追加」ボタンをクリック
2. 既存生徒を選択、または新規登録
3. 続柄を選択（父/母/祖父母/その他）

### 4. アカウント発行

保護者用ポータルへのログイン情報を発行：
1. 保護者詳細画面で「アカウント発行」をクリック
2. 仮パスワードが自動生成
3. メールで案内を送信

## 検索方法

- 保護者番号で完全一致検索
- 氏名で部分一致検索
- メールアドレスで検索
"""
    },
    {
        "title": "【管理者】請求管理",
        "summary": "請求作成・確定・入金管理の方法",
        "tags": ["管理者", "請求", "入金", "会計"],
        "is_pinned": True,
        "content": """# 請求管理

毎月の請求処理を管理する画面です。

## 請求の流れ

```
請求計算 → プレビュー確認 → 請求確定 → 入金確認 → 領収書発行
```

## 1. 請求一覧（/billing）

### 月別請求サマリー
- 各月の請求件数
- 合計金額
- 入金状況（未入金/一部入金/入金済み）

### フィルター
- 年月選択
- ステータス（未確定/確定済み/入金済み）
- 保護者/生徒名検索

## 2. 請求確定（/billing/confirmed）

### 確定処理の手順

1. 「請求確定」画面を開く
2. 対象年月を選択
3. 「計算実行」ボタンをクリック
4. プレビューを確認
   - 各生徒の授業料
   - 追加料金（教材費等）
   - 割引
5. 問題なければ「確定」ボタンをクリック

### 確定後の修正

確定後に修正が必要な場合：
1. 該当の請求を選択
2. 「修正」ボタンをクリック
3. 金額を手動で調整
4. 修正理由を入力して保存

## 3. 入金管理（/billing/payments）

### 入金登録

1. 請求一覧から対象を選択
2. 「入金登録」ボタンをクリック
3. 入金日と金額を入力
4. 「登録」をクリック

### 一括入金処理

口座振替結果の一括反映：
1. 「一括処理」ボタンをクリック
2. CSVファイルをアップロード
3. 内容を確認して「実行」

## 4. 領収書発行

入金済みの請求に対して領収書を発行：
1. 請求詳細画面を開く
2. 「領収書発行」ボタンをクリック
3. PDFがダウンロードされます

## 5. 相殺処理（/billing/offsets）

払い戻しや調整が必要な場合：
1. 「相殺登録」をクリック
2. 対象の保護者を選択
3. 金額と理由を入力
4. 次回請求から自動で相殺

## 注意事項

- 確定処理は月に1回のみ
- 確定後の大幅な修正は管理者権限が必要
- 領収書は入金済みの請求のみ発行可能
"""
    },
    {
        "title": "【管理者】授業・スケジュール管理",
        "summary": "授業の登録とスケジュール管理",
        "tags": ["管理者", "授業", "スケジュール", "カレンダー"],
        "content": """# 授業・スケジュール管理

授業の作成、スケジュール管理、講師の割り当てを行います。

## 1. 授業一覧（/lessons）

### 授業の種類
- **通常授業**: 定期的な授業
- **講習授業**: 夏期/冬期/春期講習
- **特別授業**: イベント、テスト等

### 授業作成

1. 「新規作成」ボタンをクリック
2. 基本情報を入力
   - 授業名
   - 科目
   - 対象学年
   - 定員
   - 料金
3. スケジュールを設定
   - 曜日/時間
   - 開始日/終了日
   - 繰り返し設定
4. 「保存」をクリック

## 2. カレンダー（/calendar）

### 表示モード
- **月表示**: 月間の授業一覧
- **週表示**: 週間の詳細スケジュール
- **日表示**: 1日の時間割

### 操作方法

- カレンダー上でドラッグ＆ドロップで授業を移動
- クリックで詳細表示
- ダブルクリックで編集

### 色分け
- 青: 通常授業
- 緑: 講習授業
- 赤: キャンセル/休講

## 3. 出席管理

### 出席登録
1. 授業詳細を開く
2. 「出席管理」タブを選択
3. 各生徒の出席状況をチェック
   - 出席
   - 欠席
   - 遅刻
   - 振替

### 振替処理
1. 欠席した授業を選択
2. 「振替登録」をクリック
3. 振替先の授業を選択
4. 保存

## 4. 講師の割り当て

1. 授業詳細画面で「講師設定」
2. 担当講師を選択
3. メイン/サブを指定

## よくある操作

### 休講設定
1. カレンダーで該当日を選択
2. 「休講」をクリック
3. 休講理由を入力
4. 保護者への通知オプションを選択
"""
    },
    {
        "title": "【管理者】チャット機能",
        "summary": "保護者とのチャットコミュニケーション",
        "tags": ["管理者", "チャット", "メッセージ"],
        "content": """# チャット機能

保護者とリアルタイムでコミュニケーションを取る機能です。

## 画面構成（/chat）

### 左パネル: チャット一覧
- 保護者との会話一覧
- 未読バッジ表示
- 最終メッセージの抜粋

### 右パネル: 会話画面
- メッセージ履歴
- 入力エリア
- ファイル添付ボタン

## 基本操作

### メッセージ送信
1. 送信先の会話を選択
2. メッセージを入力
3. Enterキーまたは送信ボタンで送信

### ファイル送付
対応形式：
- 画像（JPG, PNG, GIF）
- PDF
- Word/Excel

1. クリップアイコンをクリック
2. ファイルを選択
3. 送信

### テンプレート利用
よく使う定型文を素早く挿入：
1. テンプレートアイコンをクリック
2. カテゴリを選択
3. 使用するテンプレートをクリック
4. 必要に応じて編集して送信

## 一斉送信（/messages）

複数の保護者に同時にメッセージを送信：

1. 「一斉送信」をクリック
2. 送信先を選択
   - 全員
   - 校舎別
   - 学年別
   - 個別選択
3. メッセージを作成
4. 送信日時を設定（即時/予約）
5. 「送信」をクリック

## 通知設定

### 管理者側
- 新着メッセージの通知音
- デスクトップ通知
- メール通知

### 保護者側への通知
- アプリ内通知
- メール通知（設定による）

## 注意事項

- 送信したメッセージは削除できません
- 機密情報は送信しないでください
- 営業時間外の対応ルールを確認してください
"""
    },
    {
        "title": "【管理者】スタッフ管理",
        "summary": "講師・スタッフの登録と権限管理",
        "tags": ["管理者", "スタッフ", "講師", "権限"],
        "content": """# スタッフ管理

講師やスタッフの情報管理、権限設定を行います。

## 1. スタッフ一覧（/staff）

### 表示項目
- スタッフ番号
- 氏名
- 役職
- 所属校舎
- ステータス（在籍/休職/退職）

### スタッフ登録

1. 「新規登録」をクリック
2. 基本情報を入力
   - 姓名（漢字・カナ）
   - メールアドレス
   - 電話番号
   - 役職
   - 所属校舎
3. 勤務情報を設定
   - 雇用形態
   - 勤務開始日
4. 「保存」をクリック

### アカウント発行

1. スタッフ詳細画面を開く
2. 「アカウント発行」をクリック
3. 初期パスワードが生成される
4. メールで案内を送信

## 2. グループ管理（/staff/groups）

スタッフをグループ分けして管理：

### グループ作成
1. 「グループ作成」をクリック
2. グループ名を入力
3. メンバーを追加
4. 保存

### 用途
- シフト管理
- 連絡グループ
- 権限の一括設定

## 3. 権限管理（/permissions）

### 権限レベル
- **管理者**: 全機能へのアクセス
- **マネージャー**: 請求を除く管理機能
- **講師**: 授業・生徒情報の閲覧
- **スタッフ**: 限定的なアクセス

### 権限設定方法

1. 「権限設定」タブを開く
2. スタッフまたはグループを選択
3. 各機能のアクセス権を設定
   - 閲覧のみ
   - 編集可能
   - アクセス不可
4. 保存

### カスタム権限

特定の機能のみアクセスを許可：
1. 「カスタム権限作成」をクリック
2. 権限名を入力
3. 許可する機能を選択
4. スタッフに割り当て

## 注意事項

- 自分の権限を自分で変更することはできません
- 管理者権限は最低1名に付与が必要です
- 退職処理をするとログインが無効になります
"""
    },
    {
        "title": "【管理者】マニュアル・テンプレート管理",
        "summary": "社内マニュアルとチャットテンプレートの管理",
        "tags": ["管理者", "マニュアル", "テンプレート", "ナレッジ"],
        "content": """# マニュアル・テンプレート管理

社内のナレッジ管理とチャット返信テンプレートを管理します。

## 1. マニュアル管理（/knowledge/manuals）

### マニュアル一覧
- タイトル
- カテゴリ
- 作成日/更新日
- 閲覧数

### マニュアル作成

1. 「新規作成」をクリック
2. 以下を入力
   - タイトル
   - カテゴリ（選択）
   - 本文（Markdown形式）
   - タグ
3. 「保存」または「下書き保存」

### Markdown記法

本文はMarkdown形式で記述できます：

```markdown
# 見出し1
## 見出し2
### 見出し3

**太字** *斜体*

- リスト1
- リスト2

1. 番号付きリスト
2. 番号付きリスト

[リンクテキスト](URL)

![画像の説明](画像URL)

| 表 | ヘッダー |
|---|---|
| セル | セル |
```

### 画像の追加

本文中に画像を挿入：
1. 画像をアップロード
2. 生成されたURLをコピー
3. Markdown形式で挿入: `![説明](URL)`

または、images フィールドにJSON形式で追加：
```json
[{"url": "https://...", "alt": "説明"}]
```

### カテゴリ管理

1. 「カテゴリ管理」をクリック
2. 新規カテゴリを作成
3. 親カテゴリを設定（階層化）
4. 表示順を設定

## 2. テンプレート管理（/knowledge/templates）

### テンプレート一覧
- タイトル
- 種別（チャット/メール/SMS）
- 使用場面
- 使用回数

### テンプレート作成

1. 「新規作成」をクリック
2. 以下を入力
   - タイトル
   - 種別を選択
   - カテゴリ
   - 使用場面の説明
   - 本文
3. 変数を設定（置換される部分）
4. 保存

### 変数の使い方

本文中で `{変数名}` の形式で記述：

```
{保護者名}様

お子様（{生徒名}）の授業について、ご連絡いたします。
{校舎名}では...
```

使用可能な変数：
- 保護者名
- 生徒名
- 校舎名
- 日付
- 時間

### デフォルト設定

特定の場面で自動的に選択されるテンプレート：
1. テンプレートを開く
2. 「デフォルトに設定」をチェック
3. 保存

## 検索機能

- タイトル検索
- 本文内検索
- タグ検索
- カテゴリフィルター
"""
    },
    {
        "title": "【管理者】契約管理",
        "summary": "生徒の契約・入会・退会の管理",
        "tags": ["管理者", "契約", "入会", "退会"],
        "content": """# 契約管理

生徒の入会契約、コース変更、退会処理を管理します。

## 契約一覧（/contracts）

### 表示情報
- 契約番号
- 生徒名
- 契約コース
- 契約開始日
- 契約状況（有効/休会/解約）
- 月額料金

### フィルター
- 契約状況
- コース
- 校舎
- 契約期間

## 新規契約の作成

### 1. 入会申請から
保護者ポータルからの入会申請を承認：
1. 「入会申請」一覧を開く
2. 申請内容を確認
3. 「承認」または「却下」
4. 承認時、契約が自動作成

### 2. 手動作成
1. 「新規契約」をクリック
2. 生徒を選択（または新規登録）
3. コースを選択
4. 契約条件を入力
   - 契約開始日
   - 料金プラン
   - 支払い方法
5. 「契約作成」をクリック

## 契約変更

### コース変更
1. 契約詳細を開く
2. 「コース変更」をクリック
3. 新しいコースを選択
4. 変更開始日を設定
5. 料金の差額を確認
6. 保存

### 休会処理
1. 契約詳細を開く
2. 「休会」をクリック
3. 休会期間を設定
4. 休会理由を入力
5. 休会中の料金設定を確認
6. 保存

## 退会処理

1. 契約詳細を開く
2. 「退会」をクリック
3. 退会日を設定
4. 退会理由を入力
5. 清算金額を確認
6. 「退会処理」をクリック

### 退会時の処理
- 未使用チケットの払い戻し
- 最終請求の作成
- アカウントの停止

## 注意事項

- 契約変更は翌月から適用が基本
- 月途中の退会は日割り計算
- 退会後の復会は新規契約として処理
"""
    },
    {
        "title": "【管理者】フィード・お知らせ管理",
        "summary": "お知らせの作成と配信",
        "tags": ["管理者", "フィード", "お知らせ", "通知"],
        "content": """# フィード・お知らせ管理

保護者・社員向けのお知らせを配信する機能です。

## フィード一覧（/feed）

### 表示項目
- タイトル
- カテゴリ
- 配信日時
- 対象者
- 公開状態

## お知らせ作成

1. 「新規作成」をクリック
2. 基本情報を入力
   - タイトル
   - カテゴリ
   - 本文
3. 配信設定
   - 配信先（全員/校舎別/学年別）
   - 公開日時（即時/予約）
4. 保存

### 本文の作成

リッチテキストエディタで作成：
- 文字装飾（太字、斜体、下線）
- リスト
- リンク挿入
- 画像挿入

### 画像の追加

1. エディタ内の画像ボタンをクリック
2. ファイルを選択してアップロード
3. サイズを調整
4. 挿入位置を決定

## 配信対象の設定

### 全員
全ての保護者・社員に配信

### 校舎別
1. 「校舎選択」をクリック
2. 対象校舎をチェック
3. 適用

### 学年別
1. 「学年選択」をクリック
2. 対象学年をチェック
3. 適用

### 個別選択
特定の保護者のみに配信：
1. 「個別選択」をクリック
2. 保護者を検索・選択
3. 適用

## 予約配信

1. 「配信日時」で「予約」を選択
2. 日時を設定
3. 保存

予約済みのお知らせは「予約一覧」で確認・編集可能

## 配信後の編集

- 公開後も編集可能
- 編集履歴が残ります
- 削除すると閲覧不可に

## プッシュ通知

重要なお知らせはプッシュ通知も送信：
1. 「プッシュ通知を送信」にチェック
2. 通知タイトルを入力
3. 保存・配信
"""
    },
    {
        "title": "【管理者】設定・システム管理",
        "summary": "システム全体の設定と管理",
        "tags": ["管理者", "設定", "システム"],
        "content": """# 設定・システム管理

システム全体の設定を管理します。

## 設定画面（/settings）

### 1. 基本設定

#### 塾情報
- 塾名
- 住所
- 電話番号
- メールアドレス
- ロゴ画像

#### 営業時間
- 営業日設定
- 営業時間
- 休業日設定

### 2. 請求設定

#### 締め日
- 請求締め日（毎月XX日）
- 支払い期限（締め日からXX日後）

#### 消費税
- 税率設定
- 内税/外税設定

#### 請求書設定
- 請求書フォーマット
- 振込先情報
- 備考欄のデフォルト

### 3. 通知設定

#### メール通知
- 送信元アドレス
- 送信元名
- 署名テンプレート

#### 自動通知
- 入会申請通知
- 請求通知
- 入金確認通知
- 授業リマインダー

### 4. 連携設定

#### 決済サービス
- 口座振替設定
- クレジットカード決済設定

#### 外部サービス
- LINE連携
- Zoom連携

## 権限設定（/settings/permissions）

詳細は「スタッフ管理」マニュアルを参照

## バックアップ

### 手動バックアップ
1. 「バックアップ」をクリック
2. バックアップ対象を選択
3. 実行

### 自動バックアップ
- 毎日深夜に自動実行
- 30日間保持

## 注意事項

- 設定変更は即座に反映されます
- 重要な設定変更は管理者のみ可能
- 変更履歴は「操作ログ」で確認可能
"""
    },
]

# =====================================
# 保護者向けマニュアル
# =====================================
CUSTOMER_MANUALS = [
    {
        "title": "【保護者】ログイン・初期設定",
        "summary": "保護者ポータルへのログイン方法と初期設定",
        "tags": ["保護者", "ログイン", "初期設定"],
        "is_pinned": True,
        "content": """# ログイン・初期設定

保護者ポータルへのログイン方法と初期設定について説明します。

## ログイン方法

### 1. ログイン画面にアクセス
ブラウザで保護者ポータルのURLにアクセスします。

### 2. ログイン情報を入力
- **メールアドレス**: 登録済みのメールアドレス
- **パスワード**: 発行されたパスワード（または変更後のパスワード）

### 3. ログインボタンをクリック

## 初回ログイン時

### パスワード変更
初回ログイン時は仮パスワードの変更が必要です：

1. 現在のパスワード（仮パスワード）を入力
2. 新しいパスワードを入力（8文字以上）
3. 新しいパスワードを再入力（確認）
4. 「変更」をクリック

### パスワードの条件
- 8文字以上
- 英字と数字を含む
- 推測されやすいパスワードは避ける

## パスワードを忘れた場合

1. ログイン画面で「パスワードを忘れた方」をクリック
2. 登録メールアドレスを入力
3. 「送信」をクリック
4. メールに届いたリンクから再設定

## ログアウト

1. 画面右上のメニューをクリック
2. 「ログアウト」を選択

## 注意事項

- 共有端末での利用後は必ずログアウト
- パスワードは定期的に変更を推奨
- 不正アクセスに気づいたら即座に連絡
"""
    },
    {
        "title": "【保護者】ホーム画面の使い方",
        "summary": "保護者ポータルのホーム画面の見方",
        "tags": ["保護者", "ホーム", "概要"],
        "content": """# ホーム画面の使い方

ログイン後に表示されるホーム画面について説明します。

## 画面構成

### 1. ヘッダー
- ロゴ（クリックでホームに戻る）
- 通知アイコン（未読数バッジ）
- メニューアイコン

### 2. お知らせエリア
塾からの最新のお知らせが表示されます。
- タップで詳細を表示
- 「すべて見る」で一覧表示

### 3. 今日の予定
- 本日の授業予定
- 開始時間
- 科目
- 講師名

### 4. お子様情報
登録されているお子様の情報：
- 名前
- 学年
- 出席状況

### 5. メニュー

下部または左側のメニューから各機能にアクセス：
- ホーム
- スケジュール
- チケット
- チャット
- 設定

## よく使う操作

### お知らせを確認
1. お知らせをタップ
2. 詳細を確認
3. 戻るボタンで戻る

### 予定を確認
1. 「スケジュール」メニューをタップ
2. カレンダーで日付を選択
3. 授業詳細を確認

### 塾に連絡
1. 「チャット」メニューをタップ
2. メッセージを入力
3. 送信
"""
    },
    {
        "title": "【保護者】お子様情報の確認・編集",
        "summary": "お子様の登録情報の確認と編集方法",
        "tags": ["保護者", "子ども", "生徒", "プロフィール"],
        "content": """# お子様情報の確認・編集

登録されているお子様の情報を確認・編集する方法です。

## お子様一覧（/children）

複数のお子様が登録されている場合、一覧で表示されます。

### 表示項目
- お子様の名前
- 学年
- 所属校舎
- 登録コース

## お子様詳細

一覧から名前をタップすると詳細画面が表示されます。

### 基本情報
- 氏名
- 生年月日
- 学年
- 学校名

### 受講情報
- 登録コース
- 担当講師
- 授業スケジュール

### 出席状況
- 今月の出席率
- 出席/欠席/振替の履歴

## 情報の編集

### 編集可能な項目
- 学校名
- 緊急連絡先
- アレルギー情報
- 備考

### 編集方法
1. 「編集」ボタンをタップ
2. 情報を修正
3. 「保存」をタップ

### 編集できない項目
以下は塾への連絡が必要です：
- 氏名
- 生年月日
- コース変更

## 複数のお子様がいる場合

1. 「お子様一覧」で切り替え
2. 各お子様の情報を個別に確認
3. スケジュールは全員分を統合表示も可能

## 注意事項

- 重要な情報変更は塾に連絡
- 学年は年度末に自動更新
- 緊急連絡先は常に最新に
"""
    },
    {
        "title": "【保護者】スケジュール・カレンダー",
        "summary": "授業スケジュールの確認方法",
        "tags": ["保護者", "スケジュール", "カレンダー", "授業"],
        "content": """# スケジュール・カレンダー

お子様の授業スケジュールを確認する方法です。

## カレンダー画面（/calendar）

### 表示モード
- **月表示**: 1ヶ月の予定を俯瞰
- **週表示**: 1週間の詳細スケジュール
- **リスト表示**: 予定を一覧で表示

### 切り替え方法
画面上部のタブで切り替え

## カレンダーの見方

### 色分け
- **青**: 通常授業
- **緑**: 講習・特別授業
- **黄**: 振替授業
- **グレー**: 休講

### 授業情報
各予定に表示される情報：
- 時間
- 科目
- 講師名
- 場所

## 詳細の確認

1. 予定をタップ
2. 詳細画面が表示
   - 授業名
   - 日時
   - 担当講師
   - 教室
   - 持ち物など

## スケジュール画面（/schedule）

### 今後の予定
直近の授業予定をリスト形式で表示

### フィルター
複数のお子様がいる場合：
- 全員の予定を表示
- 特定のお子様の予定のみ表示

## 予定の変更

### 振替申請
欠席する場合の振替申請：
1. 該当の授業をタップ
2. 「欠席・振替」をタップ
3. 振替希望日を選択
4. 申請

### 休講の通知
休講時は自動で通知されます：
- アプリ内通知
- メール通知（設定による）

## カレンダー連携

### 外部カレンダーへ登録
1. 「カレンダー連携」をタップ
2. Google/iCloudカレンダーを選択
3. 連携を許可

連携後は外部カレンダーにも予定が反映されます
"""
    },
    {
        "title": "【保護者】チケット購入",
        "summary": "授業チケットの購入方法",
        "tags": ["保護者", "チケット", "購入", "支払い"],
        "is_pinned": True,
        "content": """# チケット購入

授業で使用するチケットの購入方法を説明します。

## チケット一覧（/tickets）

### 保有チケット
現在保有しているチケットが表示されます：
- チケット種類
- 残り枚数
- 有効期限

### チケットの種類
- **通常チケット**: 通常授業用
- **講習チケット**: 夏期/冬期講習用
- **特別チケット**: イベント等

## 購入方法（/ticket-purchase）

### 1. 購入画面を開く
「チケット購入」をタップ

### 2. チケットを選択
- 購入するチケットの種類を選択
- 枚数を選択

### 3. お子様を選択
複数のお子様がいる場合、使用するお子様を選択

### 4. 支払い方法を確認
登録済みの支払い方法が表示されます：
- クレジットカード
- 口座振替（次回請求に合算）

### 5. 購入確定
「購入する」をタップして完了

## 購入履歴（/purchase-history）

### 履歴の確認
過去の購入履歴を確認できます：
- 購入日
- 商品名
- 金額
- 支払い状況

### 領収書の発行
入金済みの購入に対して領収書をダウンロード：
1. 該当の履歴を選択
2. 「領収書発行」をタップ
3. PDFがダウンロードされます

## チケットの使用

### 授業での消費
- 授業に出席するとチケットが自動消費
- 欠席時は消費されない（振替可能）

### 残数の確認
ホーム画面またはチケット一覧で確認

## 注意事項

- 購入後のキャンセルは原則不可
- 有効期限切れのチケットは無効
- チケット不足時は授業に参加できません
"""
    },
    {
        "title": "【保護者】出席確認・振替申請",
        "summary": "出席状況の確認と振替授業の申請方法",
        "tags": ["保護者", "出席", "振替", "欠席"],
        "content": """# 出席確認・振替申請

お子様の出席状況の確認と、振替授業の申請方法です。

## 出席状況の確認（/attendance）

### 月間出席状況
- 出席日数
- 欠席日数
- 振替回数
- 出席率

### 履歴
過去の出席履歴を一覧で確認：
- 日付
- 授業名
- 状態（出席/欠席/振替）

## 欠席・振替申請

### 欠席の連絡

授業に出席できない場合：

1. スケジュールから該当授業を選択
2. 「欠席連絡」をタップ
3. 欠席理由を選択
4. 「送信」をタップ

### 振替の申請

1. 欠席した授業を選択
2. 「振替申請」をタップ
3. 振替希望日を選択
   - 空きのある日程が表示されます
4. 「申請」をタップ

### 振替の制限
- 振替は授業日の前日まで申請可能
- 同月内の振替が基本
- 回数制限がある場合があります

## 振替状況の確認

### 申請中
審査中の振替申請を確認

### 確定済み
承認された振替授業を確認

### 否認
空きがない等で否認された申請

## 無断欠席の場合

- チケットは消費されます
- 振替対象外となる場合があります
- 事前連絡をお願いします

## 注意事項

- 体調不良等の急な欠席も可能な限り事前連絡を
- 振替期限を過ぎると無効になります
- 詳細は塾にお問い合わせください
"""
    },
    {
        "title": "【保護者】チャット機能",
        "summary": "塾とのチャットコミュニケーション方法",
        "tags": ["保護者", "チャット", "連絡", "メッセージ"],
        "content": """# チャット機能

塾とチャットでコミュニケーションを取る方法です。

## チャット画面（/chat）

### 画面構成
- 上部: 塾の名前/ステータス
- 中央: メッセージ履歴
- 下部: 入力エリア

## メッセージの送信

### テキストメッセージ
1. 入力エリアをタップ
2. メッセージを入力
3. 送信ボタンをタップ

### 画像の送信
1. カメラ/ギャラリーアイコンをタップ
2. 画像を選択
3. 確認して送信

### ファイルの送信
1. クリップアイコンをタップ
2. ファイルを選択
3. 送信

## メッセージの確認

### 未読メッセージ
- メニューに未読バッジが表示
- チャット画面を開くと自動で既読に

### 過去のメッセージ
- スクロールで過去のやり取りを確認
- 検索機能で特定のメッセージを探す

## 通知設定

### 新着通知
新しいメッセージが届くと通知：
- プッシュ通知
- メール通知（設定による）

### 通知設定の変更
1. 設定画面を開く
2. 「通知設定」をタップ
3. 希望の設定に変更

## よくある連絡内容

- 欠席・振替の連絡
- 授業内容の質問
- 料金に関する問い合わせ
- その他相談

## 注意事項

- 返信は営業時間内となります
- 緊急時は電話連絡をお願いします
- 個人情報の取り扱いにご注意ください
"""
    },
    {
        "title": "【保護者】支払い・請求",
        "summary": "支払い方法の設定と請求の確認",
        "tags": ["保護者", "支払い", "請求", "料金"],
        "content": """# 支払い・請求

支払い方法の設定と請求内容の確認方法です。

## 支払い方法の設定（/settings/payment）

### 登録方法
1. 設定画面を開く
2. 「支払い方法」をタップ
3. 「追加」または「変更」をタップ
4. 必要情報を入力

### クレジットカード
- カード番号
- 有効期限
- セキュリティコード

### 口座振替
- 金融機関名
- 支店名
- 口座種別
- 口座番号
- 口座名義

## 請求の確認

### 今月の請求
ホーム画面または設定画面で確認：
- 請求金額
- 内訳
- 支払い期限

### 請求履歴
過去の請求を確認：
1. 「請求履歴」をタップ
2. 年月を選択
3. 詳細を確認

## 請求明細の見方

### 明細項目
- 基本料金（月謝）
- チケット購入
- 教材費
- その他費用
- 割引
- 合計

### 消費税
税込価格で表示されます

## 入金状況

### ステータス
- 未入金
- 入金済み
- 一部入金

### 入金確認
口座振替・カード払いの結果が反映されます

## 領収書

入金済みの請求に対して発行可能：
1. 請求履歴から該当月を選択
2. 「領収書発行」をタップ
3. PDFダウンロード

## 注意事項

- 支払い期限を過ぎると延滞扱いとなります
- カード情報は安全に暗号化されます
- 不明点は塾に連絡ください
"""
    },
    {
        "title": "【保護者】設定・プロフィール編集",
        "summary": "アカウント設定とプロフィールの編集",
        "tags": ["保護者", "設定", "プロフィール", "パスワード"],
        "content": """# 設定・プロフィール編集

アカウント設定とプロフィール情報の編集方法です。

## 設定画面（/settings）

メニューから「設定」を選択してアクセス

## プロフィール編集（/settings/profile-edit）

### 編集可能な項目
- 氏名（カナ）
- メールアドレス
- 電話番号
- 住所
- 緊急連絡先

### 編集方法
1. 「プロフィール編集」をタップ
2. 情報を修正
3. 「保存」をタップ

## パスワード変更（/settings/password）

### 変更手順
1. 「パスワード変更」をタップ
2. 現在のパスワードを入力
3. 新しいパスワードを入力
4. 新しいパスワードを再入力
5. 「変更」をタップ

### パスワード要件
- 8文字以上
- 英字と数字を含む

## 通知設定

### メール通知
- お知らせ通知
- 請求通知
- チャット通知

### プッシュ通知
- 新着メッセージ
- リマインダー
- 重要なお知らせ

## メールアドレス変更

### 変更手順
1. 「メールアドレス変更」をタップ
2. 新しいメールアドレスを入力
3. 確認メールが送信される
4. メール内のリンクをクリック
5. 変更完了

## 退会

退会を希望する場合：
1. 設定画面で「退会」をタップ
2. 注意事項を確認
3. 「退会申請」をタップ
4. 塾からの連絡をお待ちください

※即時退会ではなく、清算処理後の退会となります

## 注意事項

- メールアドレスはログインIDとなります
- 重要な連絡が届くため、有効なアドレスを設定
- パスワードは定期的に変更を推奨
"""
    },
    {
        "title": "【保護者】体験授業の申込",
        "summary": "体験授業の申込方法",
        "tags": ["保護者", "体験授業", "申込"],
        "content": """# 体験授業の申込

体験授業への申込方法を説明します。

## 体験授業とは

入会前に授業を体験できる制度です：
- 無料または特別価格
- 実際の授業に参加
- 塾の雰囲気を体験

## 申込画面（/trial）

### アクセス方法
- ホーム画面の「体験授業」バナー
- メニューから「体験授業」

## 申込手順

### 1. コース選択
体験可能なコースから選択：
- コース名
- 対象学年
- 内容説明

### 2. 日時選択
空き日程から希望日時を選択：
- カレンダーで日付を選択
- 時間帯を選択

### 3. お子様情報入力
- 氏名
- 学年
- 学校名
- 希望校（中学受験等）

### 4. 保護者情報入力
- 氏名
- 電話番号
- メールアドレス

### 5. 確認・送信
内容を確認して「申込」をタップ

## 申込後の流れ

1. 確認メールが届く
2. 塾から連絡（確定/調整）
3. 体験授業に参加
4. 入会検討

## 当日の持ち物

- 筆記用具
- ノート
- （その他案内に記載のもの）

## キャンセル

体験授業をキャンセルする場合：
1. 確認メール内のリンクをクリック
2. キャンセル理由を選択
3. 送信

または塾に直接連絡

## 注意事項

- 申込は空き状況により調整の場合あり
- 当日キャンセルは避けてください
- 複数回の体験は原則不可
"""
    },
    {
        "title": "【保護者】お知らせ・フィードの確認",
        "summary": "塾からのお知らせの確認方法",
        "tags": ["保護者", "お知らせ", "フィード", "通知"],
        "content": """# お知らせ・フィードの確認

塾からのお知らせを確認する方法です。

## お知らせ一覧（/feed）

### アクセス方法
- ホーム画面の「お知らせ」セクション
- メニューの「お知らせ」

### 一覧表示
- タイトル
- 投稿日
- カテゴリ
- 未読バッジ

## お知らせの種類

### 重要なお知らせ
- 休講情報
- 料金改定
- システムメンテナンス

### 一般のお知らせ
- イベント案内
- 講習案内
- 教材情報

### お子様向け
- 宿題連絡
- テスト結果
- 個別連絡

## 詳細の確認

1. お知らせをタップ
2. 詳細画面が表示
3. 添付ファイルがあればダウンロード可能

## 通知設定

### 受け取る通知の設定
1. 設定画面を開く
2. 「通知設定」をタップ
3. カテゴリごとに設定
   - 重要：必ず受け取る
   - 一般：任意
   - お子様向け：任意

### 通知方法
- プッシュ通知
- メール通知
- アプリ内のみ

## 過去のお知らせ

### 検索
1. 検索アイコンをタップ
2. キーワードを入力
3. 該当するお知らせを表示

### フィルター
- カテゴリで絞り込み
- 期間で絞り込み

## 注意事項

- 重要なお知らせは必ずご確認ください
- 既読にしても後から確認可能
- 古いお知らせは一定期間後に削除される場合があります
"""
    },
]

# =====================================
# 社員向けマニュアル
# =====================================
SYAIN_MANUALS = [
    {
        "title": "【社員】ログイン・初期設定",
        "summary": "社員ポータルへのログインと初期設定",
        "tags": ["社員", "ログイン", "初期設定"],
        "is_pinned": True,
        "content": """# ログイン・初期設定

社員ポータルへのログイン方法と初期設定について説明します。

## ログイン画面（/login）

### ログイン方法
1. 社員ポータルのURLにアクセス
2. メールアドレスを入力
3. パスワードを入力
4. 「ログイン」をクリック

## 初回ログイン

### プロフィール設定（/profile-setup）

初回ログイン時は以下の設定が必要：

1. **基本情報**
   - 氏名（表示名）
   - 電話番号
   - 緊急連絡先

2. **プロフィール写真**
   - 任意ですが設定推奨
   - 生徒・保護者に表示されます

3. **担当科目**
   - 担当可能な科目を選択

4. **勤務可能時間**
   - 曜日ごとの勤務可能時間を設定

### パスワード変更

1. 仮パスワードでログイン
2. 新しいパスワードを設定
3. 8文字以上、英数字混合

## ホーム画面（/home）

ログイン後のトップページ：
- 今日の担当授業
- 未確認の連絡
- タスク一覧

## セットアップ（/setup）

追加の初期設定：
- 通知設定
- カレンダー連携
- 表示設定

## 注意事項

- パスワードは他人に教えない
- 共有PCでは必ずログアウト
- 不正アクセスに気づいたら即報告
"""
    },
    {
        "title": "【社員】スケジュール管理",
        "summary": "担当授業のスケジュール確認と管理",
        "tags": ["社員", "スケジュール", "授業", "勤務"],
        "content": """# スケジュール管理

担当授業のスケジュール確認と管理方法です。

## スケジュール画面（/schedule）

### 表示内容
- 今日の担当授業
- 今週の予定
- 月間スケジュール

### 表示切替
- リスト表示
- カレンダー表示

## 担当授業の確認

### 授業詳細
各授業をタップすると詳細が表示：
- 日時
- 授業名/科目
- 生徒一覧
- 教室
- 使用教材

### 生徒情報
授業に参加する生徒の情報：
- 氏名
- 学年
- 備考（注意事項など）

## 授業の準備

### 教材確認
1. 授業詳細を開く
2. 「教材」タブを確認
3. 必要に応じてダウンロード

### 前回の記録
1. 授業詳細を開く
2. 「履歴」タブを確認
3. 前回の進捗を確認

## スケジュール変更

### 休講申請
やむを得ず休む場合：
1. 該当の授業を選択
2. 「休講申請」をタップ
3. 理由を入力
4. 代講の希望を選択
5. 申請

### 代講依頼
他の講師への代講依頼：
1. 「代講依頼」をタップ
2. 依頼先を選択
3. メッセージを入力
4. 送信

## シフト希望

### 希望シフトの提出
1. 「シフト希望」をタップ
2. 希望日時を入力
3. 提出期限までに送信

### シフト確定
確定したシフトは自動でスケジュールに反映

## 注意事項

- スケジュールは毎日確認
- 変更がある場合は早めに連絡
- 無断欠勤は厳禁
"""
    },
    {
        "title": "【社員】出席管理",
        "summary": "授業の出席管理と報告",
        "tags": ["社員", "出席", "授業", "報告"],
        "content": """# 出席管理

授業の出席管理と報告の方法です。

## 出席管理画面（/attendance）

### 本日の授業
担当授業の一覧が表示されます

### 出席登録
授業開始後に出席を登録：
1. 該当の授業を選択
2. 「出席管理」をタップ
3. 各生徒の状態を選択
   - 出席
   - 欠席
   - 遅刻
   - 早退
4. 「保存」をタップ

## 出席状態の種類

### 出席
通常通り参加

### 欠席
- 事前連絡あり
- 当日連絡あり
- 無断欠席

### 遅刻
到着時間を記録

### 早退
退出時間を記録

## 出席の修正

誤って登録した場合：
1. 該当の授業を開く
2. 生徒の状態をタップ
3. 正しい状態を選択
4. 保存

※授業日から3日以内のみ修正可能

## 授業報告

### 報告内容
授業終了後に報告：
1. 「授業報告」をタップ
2. 進捗を入力
3. 生徒ごとのコメント
4. 次回への申し送り
5. 提出

### 報告項目
- 進んだ範囲
- 生徒の理解度
- 宿題の指示
- 特記事項

## 欠席生徒のフォロー

### 連絡確認
欠席連絡の有無を確認

### 振替対応
振替希望がある場合の対応

## 注意事項

- 出席は授業終了後すぐに登録
- 報告は当日中に完了
- 気になる生徒がいれば備考に記載
"""
    },
    {
        "title": "【社員】生徒管理",
        "summary": "担当生徒の情報確認と管理",
        "tags": ["社員", "生徒", "情報", "管理"],
        "content": """# 生徒管理

担当生徒の情報確認と管理方法です。

## 生徒一覧（/students）

### 表示範囲
- 担当授業に在籍する生徒
- 過去に担当した生徒

### 検索・フィルター
- 氏名で検索
- 学年でフィルター
- 授業でフィルター

## 生徒詳細（/students/[id]）

### 基本情報
- 氏名
- 学年
- 学校名
- 所属校舎

### 受講情報
- 登録コース
- 授業スケジュール
- 担当講師

### 出席状況
- 出席率
- 最近の出席履歴

### 成績情報
- テスト結果（権限による）
- 学習進捗

## 生徒へのコメント

### 授業コメント
1. 生徒詳細を開く
2. 「コメント」タブを選択
3. 「新規コメント」をタップ
4. 内容を入力
5. 公開範囲を選択
   - 社内のみ
   - 保護者にも公開
6. 保存

### コメント履歴
過去のコメントを確認可能

## 保護者情報

### 確認可能な情報
- 保護者氏名
- 連絡先（緊急時用）

### 連絡方法
直接連絡は管理者を通して行う

## スマートノート（/smart-note）

### 機能
生徒ごとの学習記録：
- 理解度の記録
- 苦手分野のメモ
- 次回の指導ポイント

### 使い方
1. 生徒を選択
2. ノートを開く
3. 記録を追加
4. 保存

## 注意事項

- 個人情報の取り扱いに注意
- 生徒情報の外部持ち出し禁止
- 気になることは管理者に報告
"""
    },
    {
        "title": "【社員】チャット・連絡",
        "summary": "社内チャットとコミュニケーション",
        "tags": ["社員", "チャット", "連絡", "コミュニケーション"],
        "content": """# チャット・連絡

社内でのコミュニケーション方法です。

## チャット画面（/chat）

### 画面構成
- 左: 会話一覧
- 右: メッセージ画面

### 会話の種類
- 管理者との連絡
- 講師間の連絡
- グループチャット

## メッセージの送信

### テキスト
1. 会話を選択
2. メッセージを入力
3. 送信

### ファイル送付
1. クリップアイコンをタップ
2. ファイルを選択
3. 送信

### 画像
1. カメラアイコンをタップ
2. 撮影または選択
3. 送信

## 新規会話

### 個人チャット
1. 「新規」をタップ
2. 相手を選択
3. メッセージを送信

### グループ作成
1. 「新規グループ」をタップ
2. グループ名を入力
3. メンバーを追加
4. 作成

## 通知設定

### 通知の種類
- プッシュ通知
- 音声通知
- メール通知

### 設定方法
1. チャット設定を開く
2. 通知設定を選択
3. 希望の設定に変更

## 既読機能

- メッセージ送信後、相手が読むと既読に
- グループでは既読人数が表示

## フィード（/feed）

### 会社からのお知らせ
重要な連絡事項を確認：
- シフトに関する連絡
- 制度変更の案内
- イベント情報

### 確認方法
1. フィードを開く
2. お知らせをタップ
3. 詳細を確認
4. 必要に応じてアクション

## 注意事項

- 業務連絡は記録として残ります
- 私用チャットは控える
- 重要な連絡は確認したら返信を
"""
    },
    {
        "title": "【社員】タスク管理",
        "summary": "業務タスクの確認と管理",
        "tags": ["社員", "タスク", "業務", "TODO"],
        "content": """# タスク管理

業務タスクの確認と管理方法です。

## タスク画面（/tasks）

### タスク一覧
自分に割り当てられたタスク：
- タイトル
- 期限
- 優先度
- ステータス

### フィルター
- 未完了のみ
- 完了済み
- 期限切れ
- 優先度別

## タスクの種類

### 定期タスク
- 授業準備
- 報告書作成
- 教材確認

### 臨時タスク
- イベント対応
- 保護者対応
- その他依頼事項

## タスクの操作

### 詳細確認
1. タスクをタップ
2. 詳細を確認
   - 説明
   - 添付ファイル
   - コメント

### 完了報告
1. タスクを選択
2. 「完了」をタップ
3. 必要に応じてコメント
4. 送信

### 進捗報告
途中経過を報告：
1. タスクを選択
2. 「コメント」をタップ
3. 進捗を入力
4. 送信

## タスクの作成

自分用のタスクを作成：
1. 「新規タスク」をタップ
2. タイトルを入力
3. 期限を設定
4. 詳細を入力
5. 保存

## 期限管理

### リマインダー
- 期限前日に通知
- 期限当日に通知
- 期限切れ時に通知

### 期限延長
やむを得ず延長が必要な場合：
1. タスクを開く
2. 「期限延長申請」をタップ
3. 理由と新しい期限を入力
4. 申請

## 注意事項

- 期限は必ず守る
- 難しい場合は早めに相談
- 完了報告を忘れずに
"""
    },
    {
        "title": "【社員】設定・プロフィール",
        "summary": "個人設定とプロフィールの管理",
        "tags": ["社員", "設定", "プロフィール", "パスワード"],
        "content": """# 設定・プロフィール

個人設定とプロフィールの管理方法です。

## 設定画面（/settings）

### メニュー
- プロフィール編集
- パスワード変更
- 通知設定
- 表示設定

## プロフィール編集

### 編集可能項目
- 表示名
- プロフィール写真
- 電話番号
- 緊急連絡先
- 自己紹介

### 編集方法
1. 「プロフィール編集」をタップ
2. 情報を更新
3. 「保存」をタップ

## パスワード変更

### 変更手順
1. 「パスワード変更」をタップ
2. 現在のパスワードを入力
3. 新しいパスワードを入力
4. 確認のため再入力
5. 「変更」をタップ

### パスワード要件
- 8文字以上
- 英数字混合
- 推測されにくいもの

## 通知設定

### 通知の種類
- タスク通知
- チャット通知
- スケジュール通知
- お知らせ通知

### 設定方法
1. 「通知設定」をタップ
2. 各項目のON/OFFを設定
3. 保存

## 表示設定

### カスタマイズ
- ダークモード
- 文字サイズ
- 言語設定

## 勤務設定

### 勤務可能時間
1. 「勤務設定」をタップ
2. 曜日ごとの可能時間を設定
3. 保存

シフト作成時の参考にされます

## ログアウト（/logout）

### 方法
1. メニューから「ログアウト」
2. 確認して実行

### 注意
- 共有端末では必ずログアウト
- 保存していない情報は失われます

## 注意事項

- 連絡先は常に最新に
- パスワードは定期的に変更
- 設定変更は即座に反映
"""
    },
    {
        "title": "【社員】契約確認",
        "summary": "担当生徒の契約情報確認",
        "tags": ["社員", "契約", "情報"],
        "content": """# 契約確認

担当生徒の契約情報を確認する方法です。

## 契約一覧（/contracts）

### 表示範囲
担当生徒の契約情報が確認できます

### 表示項目
- 生徒名
- 契約コース
- 契約状況
- 開始日

## 契約詳細

### 確認可能な情報
- 契約コース
- 授業回数
- 開始日/終了日
- 契約状況

### 確認できない情報
（権限による制限）
- 料金情報
- 支払い状況
- 保護者の詳細

## 契約状況の種類

### 有効
通常の契約状態

### 休会
一時的に授業を休止中

### 解約予定
解約が予定されている状態

## 確認のタイミング

### 授業前
- 生徒の契約が有効か確認
- 受講可能な科目を確認

### 変更時
- 休会から復帰した場合
- コース変更があった場合

## 注意事項

- 契約情報は閲覧のみ
- 変更・更新は管理者が行う
- 不明点は管理者に確認
- 契約情報は機密扱い
"""
    },
    {
        "title": "【社員】授業詳細管理",
        "summary": "担当授業の詳細確認と管理",
        "tags": ["社員", "授業", "詳細", "管理"],
        "content": """# 授業詳細管理

担当授業の詳細確認と管理方法です。

## 授業詳細（/classes/[id]）

### アクセス方法
1. スケジュールから授業を選択
2. 「詳細」をタップ

### 表示情報
- 授業名
- 日時
- 教室
- 参加生徒
- 使用教材

## 授業の準備

### 生徒の確認
参加予定の生徒一覧：
- 氏名
- 学年
- 特記事項

### 教材の確認
使用する教材：
- テキスト名
- ページ範囲
- プリント類

### 前回の振り返り
1. 「履歴」タブを選択
2. 前回の授業内容を確認
3. 申し送り事項を確認

## 授業中の操作

### 出席登録
授業開始時に登録

### メモ機能
授業中の気づきをメモ：
1. 「メモ」をタップ
2. 内容を入力
3. 保存（自動保存あり）

## 授業後の処理

### 出席確定
全生徒の出席状態を確認して保存

### 授業報告
1. 「報告作成」をタップ
2. 進捗を入力
3. 生徒ごとのコメント
4. 次回への申し送り
5. 提出

### 宿題の記録
出した宿題を記録：
1. 「宿題」タブを選択
2. 「宿題追加」をタップ
3. 内容と期限を入力
4. 保存

## スマートノート連携

授業での気づきを生徒ごとに記録：
1. 生徒名をタップ
2. 「スマートノート」を選択
3. 記録を追加

## 注意事項

- 授業報告は当日中に
- 重要な事項は詳しく記録
- 次回担当者への引き継ぎを意識
"""
    },
]


def main():
    """メイン処理"""
    print("=" * 60)
    print("全機能マニュアル作成スクリプト")
    print("=" * 60)

    # テナントを取得
    tenants = Tenant.objects.all()
    if not tenants.exists():
        print("エラー: テナントが見つかりません")
        return

    print(f"\n対象テナント数: {tenants.count()}")

    for tenant in tenants:
        tenant_name = getattr(tenant, 'tenant_name', None) or getattr(tenant, 'name', str(tenant.id))
        print(f"\n{'='*40}")
        print(f"テナント: {tenant_name}")
        print(f"{'='*40}")

        # カテゴリを作成
        admin_category = get_or_create_category(tenant, "管理者向けマニュアル", sort_order=1)
        customer_category = get_or_create_category(tenant, "保護者向けマニュアル", sort_order=2)
        syain_category = get_or_create_category(tenant, "社員向けマニュアル", sort_order=3)

        # 管理者向けマニュアル
        print("\n--- 管理者向けマニュアル ---")
        for i, manual_data in enumerate(ADMIN_MANUALS):
            create_manual(
                tenant=tenant,
                category=admin_category,
                title=manual_data["title"],
                content=manual_data["content"],
                summary=manual_data["summary"],
                tags=manual_data["tags"],
                sort_order=i,
                is_pinned=manual_data.get("is_pinned", False),
            )

        # 保護者向けマニュアル
        print("\n--- 保護者向けマニュアル ---")
        for i, manual_data in enumerate(CUSTOMER_MANUALS):
            create_manual(
                tenant=tenant,
                category=customer_category,
                title=manual_data["title"],
                content=manual_data["content"],
                summary=manual_data["summary"],
                tags=manual_data["tags"],
                sort_order=i,
                is_pinned=manual_data.get("is_pinned", False),
            )

        # 社員向けマニュアル
        print("\n--- 社員向けマニュアル ---")
        for i, manual_data in enumerate(SYAIN_MANUALS):
            create_manual(
                tenant=tenant,
                category=syain_category,
                title=manual_data["title"],
                content=manual_data["content"],
                summary=manual_data["summary"],
                tags=manual_data["tags"],
                sort_order=i,
                is_pinned=manual_data.get("is_pinned", False),
            )

    # 結果サマリー
    total_manuals = Manual.objects.count()
    total_categories = ManualCategory.objects.count()

    print("\n" + "=" * 60)
    print("作成完了!")
    print("=" * 60)
    print(f"カテゴリ総数: {total_categories}")
    print(f"マニュアル総数: {total_manuals}")
    print(f"  - 管理者向け: {len(ADMIN_MANUALS)} × {tenants.count()} テナント")
    print(f"  - 保護者向け: {len(CUSTOMER_MANUALS)} × {tenants.count()} テナント")
    print(f"  - 社員向け: {len(SYAIN_MANUALS)} × {tenants.count()} テナント")


if __name__ == "__main__":
    main()
else:
    # Django shell から実行された場合
    main()
